<script>
  // === Site config you can customize ===
  const BUSINESS = {
    name: "BIG TURD Waste Removal",
    phone: "323-574-0882",
    email: "bigturdservice@yahoo.com",
    city: "Terre Haute and surrounding cities",
    serviceZips: [
      "47801","47802","47803","47804","47805","47807","47806","47808","47809","47810"
    ]
  };

  const PRICING = {
    small: {
      weekly:   { price: 62.99,  link: 'https://buy.stripe.com/cNi9ATf7tg1najn3mC6g80g' },
      twice:    { price: 109.99, link: 'https://buy.stripe.com/cNi14n2kH6qN4Z3f5k6g80u' },
      biweekly: { price: 42.99,  link: 'https://buy.stripe.com/8x29AT4sP3eBgHL3mC6g80i' },
      onetime:  { price: 69.00,  link: 'https://buy.stripe.com/6oU14n4sP02pgHL4qG6g80j' }
    },
    medium: {
      weekly:   { price: 69.99,  link: 'https://buy.stripe.com/4gM00j8J5bL7dvzaP46g80k' },
      twice:    { price: 119.99, link: 'https://buy.stripe.com/eVqaEXgbx5mJ1MR0aq6g80l' },
      biweekly: { price: 48.99,  link: 'https://buy.stripe.com/3cI28r8J5cPb77bg9o6g80m' },
      onetime:  { price: 79.00,  link: 'https://buy.stripe.com/9B614n7F116t8bfbT86g80n' }
    },
    large: {
      weekly:   { price: 88.99,  link: 'https://buy.stripe.com/5kQ00jbVheXjbnr7CS6g80o' },
      twice:    { price: 149.99, link: 'https://buy.stripe.com/28EfZh3oLbL79fjaP46g80t' },
      biweekly: { price: 59.99,  link: 'https://buy.stripe.com/28E3cv8J57uR2QVcXc6g80q' },
      onetime:  { price: 89.00,  link: 'https://buy.stripe.com/eVq00j8J52ax3UZe1g6g80r' }
    }
  };

  let currentService = 'weekly';
  let currentYard = 'small';   // ✅ FIXED — matches UI default
  let currentDogs = 1;

  function selectService(service) {
    currentService = service;
    document.querySelectorAll('[id^="card-"]').forEach(card => {
      card.classList.remove('selected');
    });
    document.getElementById('card-' + service).classList.add('selected');
    updatePrice();
  }

  function selectYard(yard) {
    currentYard = yard;
    document.querySelectorAll('[id^="yard-"]').forEach(card => {
      card.classList.remove('selected');
    });
    document.getElementById('yard-' + yard).classList.add('selected');
    updatePrice();
  }

  function selectDogs(dogs) {
    currentDogs = dogs;
    document.querySelectorAll('[id^="dog-"]').forEach(card => {
      card.classList.remove('selected');
    });
    document.getElementById('dog-' + dogs).classList.add('selected');
    updatePrice();
  }

  function updatePrice() {

    const needsCustomQuote = currentDogs === 4 || currentYard === 'xlarge';
      
    if (needsCustomQuote) {
      document.getElementById('price').innerHTML = 'Call Us';
      let reason = [];
      if (currentDogs === 4) reason.push('4+ dogs');
      if (currentYard === 'xlarge') reason.push('20,000+ sq ft');
      document.getElementById('period').textContent = reason.join(' • ') + ' • Custom quote required';
      document.getElementById('breakdown').style.display = 'none';
      document.getElementById('checkoutBtn').style.display = 'none';
      document.getElementById('customQuote').style.display = 'block';
      return;
    }

    document.getElementById('breakdown').style.display = 'block';
    document.getElementById('checkoutBtn').style.display = 'inline-flex';
    document.getElementById('customQuote').style.display = 'none';

    const baseData = PRICING[currentYard][currentService];

    // ✅ Dynamic dog pricing — only charges for extra dogs
    const dogFee = currentDogs > 1 ? (currentDogs - 1) * 7 : 0;

    const totalPrice = baseData.price + dogFee;

    const serviceName =
      currentService === 'weekly' ? 'Weekly' :
      currentService === 'twice' ? 'Twice Weekly' :
      currentService === 'biweekly' ? 'Every Other Week' : 'One-Time';

    document.getElementById('price').textContent = '$' + totalPrice.toFixed(2);
    document.getElementById('period').textContent =
      `${serviceName} • ${currentDogs} Dog${currentDogs > 1 ? 's' : ''} • ${currentYard.charAt(0).toUpperCase() + currentYard.slice(1)} Yard`;

    document.getElementById('basePrice').textContent = '$' + baseData.price.toFixed(2);
    document.getElementById('totalPrice').textContent = '$' + totalPrice.toFixed(2);

    const dogRow = document.getElementById('dogRow');
    if (dogFee > 0) {
      dogRow.style.display = 'flex';
      document.getElementById('dogPrice').textContent = '+$' + dogFee.toFixed(2);
    } else {
      dogRow.style.display = 'none';
    }

    // Optional: Hide yard upgrade row entirely since pricing already baked in
    document.getElementById('yardRow').style.display = 'none';
  }

  function checkout() {
    if (currentDogs === 4 || currentYard === 'xlarge') {
      window.location.href = 'tel:' + BUSINESS.phone.replace(/-/g, '');
      return;
    }
      
    const data = PRICING[currentYard][currentService];
    if (data && data.link) {
      window.open(data.link, '_blank');
    } else {
      alert('Please select valid options before checkout.');
    }
  }

  function fillBusinessBits() {
    document.querySelectorAll('[data-business-name]').forEach(el => el.textContent = BUSINESS.name);
    document.querySelectorAll('[data-business-phone]').forEach(el => el.textContent = BUSINESS.phone);
    document.querySelectorAll('[data-business-email]').forEach(el => { 
      el.textContent = BUSINESS.email; 
      el.href = 'mailto:' + BUSINESS.email; 
    });
  }

  function sendContactEmail() {
    const name = document.getElementById('contactName').value.trim();
    const email = document.getElementById('contactEmail').value.trim();
    const phone = document.getElementById('contactPhone').value.trim();
    const message = document.getElementById('contactMessage').value.trim();

    if (!name || !email) {
      alert('Please fill in at least your name and email.');
      return;
    }

    const subject = `Contact Request - ${encodeURIComponent(BUSINESS.name)}`;
    const body = encodeURIComponent(
      `Name: ${name}\nEmail: ${email}\nPhone: ${phone}\nMessage: ${message}\n---\nNotes:`
    );

    window.location.href = `mailto:${BUSINESS.email}?subject=${subject}&body=${body}`;
  }

  document.addEventListener('DOMContentLoaded', () => {
    fillBusinessBits();
    updatePrice();
    const btn = document.getElementById('mobileMenuBtn');
    const menu = document.getElementById('mobileMenu');
    btn.addEventListener('click', () => menu.classList.toggle('hidden'));
    document.getElementById('contactSubmit').addEventListener('click', sendContactEmail);
  });
</script>
